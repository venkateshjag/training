Ext.define("NX.proui.app.PluginStrings",{"@aggregate_priority":90,singleton:true,requires:["NX.I18n"],keys:{Crowd_Text:"Atlassian Crowd",Crowd_Description:"Manage Atlassian Crowd configuration",Crowd_CrowdSettings_Update_Error:"You do not have permission to configure Atlassian Crowd",Crowd_CrowdSettings_Update_Success:"Atlassian Crowd settings $action",Crowd_CrowdSettings_Html:'<p>Application can be configured to use <a href="https://www.atlassian.com/software/crowd" target="_blank">Atlassian Crowd</a> for user database and authentication.</p>',Crowd_CrowdSettings_Enable_FieldLabel:"Enable Crowd",Crowd_CrowdSettings_Activate_FieldLabel:"Enable Crowd Realm for authentication",Crowd_CrowdSettings_Activate_HelpText:'To control ordering, go to the <a href="#admin/security/realms">Realms</a> page.',Crowd_CrowdSettings_URL_FieldLabel:"Crowd server URL",Crowd_CrowdSettings_URL_HelpText:"For example: http://localhost:8095/crowd",Crowd_CrowdSettings_Name_FieldLabel:"Crowd application name",Crowd_CrowdSettings_Password_FieldLabel:"Crowd application password",Crowd_CrowdSettings_Request_FieldLabel:"Connection timeout",Crowd_CrowdSettings_Request_HelpText:"Seconds to wait for activity before stopping and retrying the connection. Leave blank to use the globally defined HTTP timeout.",Crowd_CrowdSettings_VerifyConnection_Text:"Verify connection",Crowd_CrowdSettings_Verified_Success:"Connection to Crowd server verified: {0}",Crowd_CrowdSettings_ClearCache_Text:"Clear cache",Crowd_CrowdSettings_ClearCache_Success:"Crowd cache has been cleared",UserToken_Text:"User Tokens",UserToken_Description:"Manage user token configuration",UserTokenSettings_Update_Error:"You do not have permission to configure user token",UserTokenSettings_Update_Success:"User Token settings $action",UserTokenSettings_Html:'<p>The user token feature allows users to authenticate securely without typical user credentials such as those used by LDAP or Crowd.</p><p>User tokens generated for this server are only valid for use on this server. Once enabled, users can access their user token from <a href="#user/usertoken">user mode</a>.</p>',UserTokenSettings_Enable_FieldLabel:"Enable user tokens",UserTokenSettings_Require_FieldLabel:"Require user tokens for repository authentication",UserTokenSettings_Require_HelpText:"This does not affect UI access",UserTokenSettings_Reset_Title:"Reset user tokens",UserTokenSettings_Reset_Html:"<p>Reset will invalidate <b>ALL</b> existing user tokens and force new tokens to be created the next time they are accessed.</p>",UserTokenSettings_ResetAll_Button:"Reset all user tokens",UserToken_Authentication_Validation:"{0} user tokens requires validation of your credentials.",UserToken_ResetAll_Success:"All user tokens have been reset",UserToken_Reset_Success:"Your user token has been reset",UserToken_ResetById_Message:"User token of {0} has been reset",UserToken_UserTokenUser_Title:"User Token",UserToken_UserTokenUser_ResetToken_Title:"Reset user token",UserToken_UserTokenUser_ResetToken_Html:"<p>Resetting a userâ€™s token will invalidate their current token and force a new token to be created the next time it is accessed by the user.</p>",UserToken_UserTokenUser_ResetToken_Button:"Reset user token",UserToken_Text:"User Token",UserToken_Description:"Access Nexus without the use of passwords",UserToken_UserTokenCurrent_Access_Title:"Access your token",UserToken_UserTokenCurrent_Access_Html:"A new user token will be created the first time it is accessed.",UserToken_UserTokenCurrent_Access_Button:"Access user token",UserToken_UserTokenCurrent_Reset_Title:"Reset your token",UserToken_UserTokenCurrent_Reset_Html:"Resetting your user token will invalidate the current token and force a new token to be created the next time it is accessed.",UserToken_UserTokenCurrent_Reset_Button:"Reset user token",UserToken_UserTokenDetails_Title:"User Token",UserToken_UserTokenDetails_Html1:"User tokens are a combination of a name and password codes. <strong>Keep these codes secret.</strong>",UserToken_UserTokenDetails_Html2:"<p>Your user token is</p>",UserToken_UserTokenDetails_Html3:"<p>Use the following in your Maven settings.xml:</p>",UserToken_UserTokenDetails_AutoClose_Html:"This window will automatically close after one minute.",UserToken_UserTokenDetails_AutoClosing_Message:"Automatically closing user token details due to timeout",Clm_ClmSettings_Permission_Error:"You do not have permission to configure IQ Server",Clm_Text:"Server",Clm_Description:"Manage IQ Server configuration",Clm_Connection_Success:"Connection to IQ Server verified: {0}",Clm_Dashboard_Title:"Dashboard",Clm_Dashboard_Description:"Open IQ Server Dashboard",ClmSettings_Html:'<p><a href="http://www.sonatype.com/nexus/product-overview/nexus-lifecycle" target="_blank">IQ Server</a> can evaluate application and organization policies.</p><p>To enable this feature configure the IQ Server URL, username and password.</p>',Clm_SettingsTestResults_Title:"Applications",Clm_SettingsTestResults_EmptyText:"No applications found",Clm_SettingsTestResults_Id_Header:"Id",Clm_SettingsTestResults_Name_Header:"Name",ClmSettings_Enable_FieldLabel:"Enable IQ Server",ClmSettings_Enable_HelpText:"Whether to use IQ Server.",ClmSettings_URL_FieldLabel:"IQ Server URL",ClmSettings_URL_HelpText:"The address of your IQ Server.",ClmSettings_URL_EmptyText:"enter a URL",ClmSettings_AuthenticationType_FieldLabel:"Authentication Method",ClmSettings_AuthenticationType_Pki:"PKI Authentication",ClmSettings_AuthenticationType_User:"User Authentication",ClmSettings_Username_FieldLabel:"Username",ClmSettings_Username_HelpText:"User with access to IQ Server.",ClmSettings_Username_EmptyText:"enter a name",ClmSettings_Password_FieldLabel:"Password",ClmSettings_Password_HelpText:"Credentials for the IQ Server User.",ClmSettings_Password_EmptyText:"enter a password",ClmSettings_ConnectionTimeout_FieldLabel:"Connection Timeout",ClmSettings_ConnectionTimeout_HelpText:"Seconds to wait for activity before stopping and retrying the connection. Leave blank to use the globally defined HTTP timeout.",ClmSettings_ConnectionTimeout_EmptyText:"enter a timeout",ClmSettings_Properties_FieldLabel:"Properties",ClmSettings_Properties_HelpText:"Additional properties to configure for IQ Server.",ClmSettings_Properties_EmptyText:"enter properties",ClmSettings_Properties_Verify_Button:"Verify connection",HealthCheckInfo_Security_Alerts_Label:"Security",HealthCheckInfo_License_Threat_Label:"License ",HealthCheckInfo_Tooltip:"License and security data is only available with a paid license.",HealthCheckInfo_LoggedInOnly_Tooltip:"The license and security data is only available once you have logged in.",HealthCheckInfo_NoPermission_Tooltip:"You do not have permission to view the license and security data.",FirewallRepositoryColumn_Header:"IQ Policy Violations",FirewallRepositoryColumn_Loading:"Loadingâ€¦",FirewallRepositoryColumn_NoViolations:"No violations",DatabaseQuorumReset_Title:"Cluster Reset",DatabaseQuorumResetConfirm_Resetting:"Resetting Cluster Size",DatabaseQuorumReset_Description:"Take your cluster down to a single node",DatabaseQuorumReset_ResetButton:"Reset Database Quorum",DatabaseQuorumResetConfirm_Title:"Confirm Cluster Reset",DatabaseQuorumResetConfirm_HelpText:"Have you ensured that other nodes in the cluster are shut down? Resetting the quorum can result in corrupt data if other nodes are still online.",DatabaseQuorumResetConfirm_Fail:"Failed to reset database cluster quorum setting!",DatabaseQuorumResetConfirm_GetLocalNode_Fail:"Unable to detect which node you are currently connected to",DatabaseQuorumResetConfirm_LocalNodeNotKnown:"Cannot reset database cluster quorum setting, the current node is unidentified",DatabaseQuorumResetConfirm_Success:"The database cluster write quorum was reset to one node"}},function(a){NX.I18n.register(a)});Ext.define("NX.proui.app.PluginConfig",{"@aggregate_priority":100,requires:["NX.State","NX.proui.app.PluginStrings"],controllers:[{id:"NX.proui.controller.Clm",active:function(){return NX.State.getValue("clm",{})["licenseValid"]&&NX.app.Application.bundleActive("com.sonatype.nexus.plugins.nexus-clm-plugin")}},{id:"NX.proui.controller.Crowd",active:function(){return NX.State.getValue("crowd",{})["licenseValid"]&&NX.app.Application.bundleActive("com.sonatype.nexus.plugins.nexus-crowd-plugin")}},"NX.proui.controller.FeatureGroups",{id:"NX.proui.controller.HealthCheckRepositoryDetail",active:function(){return NX.app.Application.bundleActive("com.sonatype.nexus.plugins.nexus-clm-plugin")}},{id:"NX.proui.controller.HealthCheckAssetDetail",active:function(){return NX.app.Application.bundleActive("com.sonatype.nexus.plugins.nexus-clm-plugin")}},{id:"NX.proui.controller.HealthCheckInfo",active:function(){return NX.app.Application.bundleActive("com.sonatype.nexus.plugins.nexus-clm-plugin")}},{id:"NX.proui.controller.FirewallRepositoryColumn",active:function(){return NX.app.Application.bundleActive("com.sonatype.nexus.plugins.nexus-clm-plugin")}},{id:"NX.proui.controller.LicenseWarnings",active:function(){return NX.State.requiresLicense()}},{id:"NX.proui.controller.UserToken",active:function(){return NX.State.getValue("usertoken",{})["licenseValid"]&&NX.app.Application.bundleActive("com.sonatype.nexus.plugins.nexus-usertoken-plugin")}},{id:"NX.proui.controller.DatabaseQuorumReset",active:function(){return true}}]});Ext.define("NX.proui.view.usertoken.UserTokenUser",{extend:"NX.view.SettingsPanel",alias:"widget.nx-proui-usertoken-user",requires:["NX.I18n"],initComponent:function(){Ext.apply(this,{title:NX.I18n.get("UserToken_UserTokenUser_Title"),settingsForm:[{xtype:"nx-settingsform",itemId:"resetAll",title:NX.I18n.get("UserToken_UserTokenUser_ResetToken_Title"),items:[{xtype:"label",html:NX.I18n.get("UserToken_UserTokenUser_ResetToken_Html")}],buttonAlign:"left",buttons:[{text:NX.I18n.get("UserToken_UserTokenUser_ResetToken_Button"),action:"reset",ui:"nx-primary",glyph:"xf023@FontAwesome"}]}]});this.callParent()}});Ext.define("NX.proui.view.usertoken.UserTokenCurrent",{extend:"NX.view.SettingsPanel",alias:"widget.nx-proui-usertoken-current",requires:["NX.I18n"],initComponent:function(){Ext.apply(this,{settingsForm:[{xtype:"form",ui:"nx-subsection",frame:true,title:NX.I18n.get("UserToken_UserTokenCurrent_Access_Title"),items:[{xtype:"label",html:NX.I18n.get("UserToken_UserTokenCurrent_Access_Html")}],buttonAlign:"left",buttons:[{text:NX.I18n.get("UserToken_UserTokenCurrent_Access_Button"),action:"access",ui:"nx-primary",glyph:"xf023@FontAwesome"}]},{xtype:"form",ui:"nx-subsection",frame:true,title:NX.I18n.get("UserToken_UserTokenCurrent_Reset_Title"),items:[{xtype:"label",html:NX.I18n.get("UserToken_UserTokenCurrent_Reset_Html")}],buttonAlign:"left",buttons:[{text:NX.I18n.get("UserToken_UserTokenCurrent_Reset_Button"),action:"reset",glyph:"xf023@FontAwesome"}]}]});this.callParent()}});Ext.define("NX.proui.view.clm.ClmSettings",{extend:"NX.view.SettingsPanel",alias:"widget.nx-proui-clm-settings",requires:["NX.Conditions","NX.I18n"],initComponent:function(){var a=this;a.settingsForm={xtype:"nx-settingsform",settingsFormSuccessMessage:"IQ Server Settings $action",api:{load:"NX.direct.clm_CLM.read",submit:"NX.direct.clm_CLM.update"},editableCondition:NX.Conditions.isPermitted("nexus:settings:update"),editableMarker:NX.I18n.get("Clm_ClmSettings_Permission_Error"),items:[{xtype:"label",html:NX.I18n.get("ClmSettings_Html")},{xtype:"checkbox",name:"enabled",fieldLabel:NX.I18n.get("ClmSettings_Enable_FieldLabel"),helpText:NX.I18n.get("ClmSettings_Enable_HelpText")},{xtype:"nx-url",name:"url",fieldLabel:NX.I18n.get("ClmSettings_URL_FieldLabel"),helpText:NX.I18n.get("ClmSettings_URL_HelpText"),emptyText:NX.I18n.get("ClmSettings_URL_EmptyText")},{xtype:"combo",name:"authenticationType",fieldLabel:NX.I18n.get("ClmSettings_AuthenticationType_FieldLabel"),editable:false,store:[["USER",NX.I18n.get("ClmSettings_AuthenticationType_User")],["PKI",NX.I18n.get("ClmSettings_AuthenticationType_Pki")]],listeners:{change:function(b){var c=this.up("form").down("#userAuthFields");if(b.getValue()==="USER"){c.show();c.enable()}else{c.hide();c.disable()}}}},{xtype:"fieldcontainer",itemId:"userAuthFields",hidden:true,items:[{xtype:"textfield",name:"username",fieldLabel:NX.I18n.get("ClmSettings_Username_FieldLabel"),helpText:NX.I18n.get("ClmSettings_Username_HelpText"),emptyText:NX.I18n.get("ClmSettings_Username_EmptyText"),allowBlank:false},{xtype:"nx-password",name:"password",fieldLabel:NX.I18n.get("ClmSettings_Password_FieldLabel"),helpText:NX.I18n.get("ClmSettings_Password_HelpText"),emptyText:NX.I18n.get("ClmSettings_Password_EmptyText"),allowBlank:false}]},{xtype:"numberfield",name:"timeout",fieldLabel:NX.I18n.get("ClmSettings_ConnectionTimeout_FieldLabel"),helpText:NX.I18n.get("ClmSettings_ConnectionTimeout_HelpText"),emptyText:NX.I18n.get("ClmSettings_ConnectionTimeout_EmptyText"),allowBlank:true,allowDecimals:false,allowExponential:false,minValue:1,maxValue:3600},{xtype:"textareafield",name:"properties",fieldLabel:NX.I18n.get("ClmSettings_Properties_FieldLabel"),helpText:NX.I18n.get("ClmSettings_Properties_HelpText"),emptyText:NX.I18n.get("ClmSettings_Properties_EmptyText"),allowBlank:true}]};a.callParent();a.down("nx-settingsform").getDockedItems('toolbar[dock="bottom"]')[0].add({xtype:"button",text:NX.I18n.get("ClmSettings_Properties_Verify_Button"),formBind:true,action:"verify"})}});Ext.define("NX.proui.view.clm.ClmDashboard",{extend:"Ext.panel.Panel",alias:"widget.nx-proui-clm-dashboard",initComponent:function(){var a=this;a.items=[{xtype:"box",html:'<p>Visit the <a href="http://www.sonatype.com/clm" target="_blank">IQ Server</a> dashboard to manage applications, organizations and policies.</p>',margin:10},{xtype:"nx-settingsform",buttons:[{xtype:"button",action:"open",ui:"nx-primary",text:"Open IQ Server Dashboard",glyph:"xf08e@FontAwesome"}]}];a.callParent()}});Ext.define("NX.proui.store.ClmApplication",{extend:"Ext.data.Store",model:"NX.coreui.model.Reference",proxy:{type:"direct",paramsAsHash:false,api:{read:"NX.direct.clm_CLM.readApplications"},reader:{type:"json",root:"data",idProperty:"id",successProperty:"success"}},sorters:{property:"name",direction:"ASC"}});Ext.define("NX.proui.view.clm.ClmSettingsTestResults",{extend:"NX.view.ModalDialog",alias:"widget.nx-proui-clm-settings-testresults",requires:["Ext.data.JsonStore","NX.I18n"],applications:undefined,initComponent:function(){var a=this;a.title=NX.I18n.get("Clm_SettingsTestResults_Title");a.layout="fit";a.closable=true;a.autoShow=true;a.modal=true;a.constrain=true;a.buttonAlign="left";a.buttons=[{text:NX.I18n.get("Button_Close"),handler:function(){this.up("window").close()}}];a.items={xtype:"grid",emptyText:NX.I18n.get("Clm_SettingsTestResults_EmptyText"),columns:[{header:NX.I18n.get("Clm_SettingsTestResults_Id_Header"),dataIndex:"id",flex:1},{header:NX.I18n.get("Clm_SettingsTestResults_Name_Header"),dataIndex:"name",flex:1}],store:Ext.create("Ext.data.JsonStore",{fields:["id","name"],data:a.applications})};a.width=NX.view.ModalDialog.LARGE_MODAL;a.maxHeight=a.height=Ext.getBody().getViewSize().height-100;a.callParent();a.center()}});Ext.define("NX.proui.controller.Clm",{extend:"NX.app.Controller",requires:["NX.State","NX.Messages","NX.Permissions","NX.Windows","NX.I18n"],stores:["ClmApplication"],views:["clm.ClmSettings","clm.ClmDashboard","clm.ClmSettingsTestResults"],refs:[{ref:"clmSettingsForm",selector:"nx-proui-clm-settings"}],init:function(){var a=this;a.getApplication().getIconController().addIcons({"feature-clm-dashboard":{file:"clm_dashboard.png",variants:["x16","x32"]}});a.getApplication().getFeaturesController().registerFeature({mode:"admin",path:"/IQ/Server",text:NX.I18n.get("Clm_Text"),description:NX.I18n.get("Clm_Description"),view:{xtype:"nx-proui-clm-settings"},iconConfig:{file:"clm_server.png",variants:["x16","x32"]},visible:function(){return NX.Permissions.check("nexus:settings:read")}},a);a.onClmStateChanged(NX.State.getValue("clm"),undefined,true);a.listen({controller:{"#State":{clmchanged:a.onClmStateChanged}},component:{"nx-proui-clm-settings button[action=verify]":{click:a.verifyConnection},"nx-proui-clm-settings nx-settingsform":{submitted:a.onSubmitted},"nx-proui-clm-dashboard":{activate:a.openDashboardWindow},"nx-proui-clm-dashboard button[action=open]":{click:a.openDashboardWindow}}})},verifyConnection:function(b){var c=b.up("form"),a=c.getForm().getFieldValues();c.getEl().mask("Checking connection to "+a.url);NX.direct.clm_CLM.verifyConnection(a,function(d){c.getEl().unmask();if(Ext.isDefined(d)&&d.success){NX.Messages.add({text:NX.I18n.format("Clm_Connection_Success",a.url),type:"success"});Ext.widget("nx-proui-clm-settings-testresults",{applications:d.data})}})},onSubmitted:function(a,b){NX.State.setValue("clm",Ext.apply(Ext.clone(NX.State.getValue("clm",{})),{enabled:b.result.data.enabled,url:b.result.data.url}))},onClmStateChanged:function(f,b,e){var d=this,c=d.getApplication().getFeaturesController(),a=false;if(b&&b.enabled&&b.url){c.unregisterFeature({mode:"admin",path:"/IQ/Dashboard"});a=true}if(f&&f.enabled&&f.url){c.registerFeature({mode:"admin",path:"/IQ/Dashboard",text:NX.I18n.get("Clm_Dashboard_Title"),description:NX.I18n.get("Clm_Dashboard_Description"),view:{xtype:"nx-proui-clm-dashboard"},weight:10,iconName:"feature-clm-dashboard",visible:function(){var g=NX.State.getValue("clm");return NX.Permissions.check("nexus:settings:read")&&g&&g.enabled&&g.url}},d);a=true}if(!e&&a){d.getController("Menu").refreshMenu()}},openDashboardWindow:function(){var a=NX.State.getValue("clm");NX.Windows.open(a.url)},loadApplications:function(){this.getClmClmApplicationsView().create().show()}});Ext.define("NX.proui.view.crowd.CrowdSettings",{extend:"NX.view.SettingsPanel",alias:"widget.nx-proui-crowd-settings",requires:["NX.Conditions","NX.I18n"],initComponent:function(){var a=this;a.settingsForm={xtype:"nx-settingsform",settingsFormSuccessMessage:NX.I18n.get("Crowd_CrowdSettings_Update_Success"),api:{load:"NX.direct.crowd_Crowd.read",submit:"NX.direct.crowd_Crowd.update"},editableCondition:NX.Conditions.isPermitted("nexus:crowd:update"),editableMarker:NX.I18n.get("Crowd_CrowdSettings_Update_Error"),items:[{xtype:"label",html:NX.I18n.get("Crowd_CrowdSettings_Html")},{xtype:"checkbox",name:"enabled",fieldLabel:NX.I18n.get("Crowd_CrowdSettings_Enable_FieldLabel")},{xtype:"checkbox",name:"realmActive",fieldLabel:NX.I18n.get("Crowd_CrowdSettings_Activate_FieldLabel"),helpText:NX.I18n.get("Crowd_CrowdSettings_Activate_HelpText")},{xtype:"nx-url",name:"url",fieldLabel:NX.I18n.get("Crowd_CrowdSettings_URL_FieldLabel"),helpText:NX.I18n.get("Crowd_CrowdSettings_URL_HelpText")},{name:"applicationName",fieldLabel:NX.I18n.get("Crowd_CrowdSettings_Name_FieldLabel")},{xtype:"nx-password",name:"applicationPassword",fieldLabel:NX.I18n.get("Crowd_CrowdSettings_Password_FieldLabel")},{xtype:"numberfield",name:"timeout",fieldLabel:NX.I18n.get("Crowd_CrowdSettings_Request_FieldLabel"),helpText:NX.I18n.get("Crowd_CrowdSettings_Request_HelpText"),allowBlank:true,allowDecimals:false,allowExponential:false,minValue:1,maxValue:3600}]};a.callParent();a.down("nx-settingsform").getDockedItems('toolbar[dock="bottom"]')[0].add({xtype:"button",text:NX.I18n.get("Crowd_CrowdSettings_VerifyConnection_Text"),formBind:true,action:"verify"},{xtype:"button",text:NX.I18n.get("Crowd_CrowdSettings_ClearCache_Text"),glyph:"xf014@FontAwesome",formBind:true,action:"clearCache"})}});Ext.define("NX.proui.view.healthcheck.HealthCheckAssetDetail",{extend:"Ext.panel.Panel",alias:"widget.nx-proui-healthcheck-healthcheckassetdetail",requires:["NX.util.Base64","NX.util.Url","NX.Windows","NX.I18n"],ui:"nx-inset",layout:"fit",repositoryName:undefined,format:undefined,path:undefined,loaded:false,active:false,listeners:{afterrender:function(){var a=this;a.active=true;a.loadInfo()}},showInfo:function(a){var b=this;b.format=a.get("format");b.repositoryName=a.get("repositoryName");b.path=a.get("name");b.loaded=false;b.loadInfo()},loadInfo:function(){var b=this;if(!b.loaded){b.removeAll();if(b.active&&b.rendered){var a=new Ext.LoadMask({msg:NX.I18n.get("HealthCheckInfo_Loading_Text"),target:b});a.show();if(b.path){b.add([{xtype:"panel",ui:"nx-subsection",frame:true,items:[{xtype:"box",border:false,autoEl:{tag:"iframe",src:NX.util.Url.urlOf("service/siesta/healthcheck/healthCheckFileDetail/"+NX.util.Base64.encode(b.path)+"/index.html?"+Ext.Object.toQueryString({format:b.format,repositoryName:b.repositoryName})),width:"100%",height:"100%",scrolling:"auto"},listeners:{afterrender:function(c){b.loaded=true;Ext.EventManager.on(c.getEl().dom,"load",function(){var d=c.getEl().dom.contentWindow.Insight;a.hide();a.destroy();if(d){b.setClmComponent(d);b.registerClmViewDetailsListener(d)}})}}}]}])}}}},setClmComponent:function(a){var b=this;NX.direct.healthcheck_AssetDetail.identify(b.repositoryName,b.path,function(c){if(Ext.isObject(c)){if(c.success){var e=c.data.componentIdentifier.format,f=c.data.componentIdentifier.coordinates,d=c.data.hash;if(b.isLegacyClm(a)){b.setLegacyClmComponent(a,e,f,d)}else{a.setCoordinates(e,f,{hash:d})}}else{a.setError({errorMessage:"Unable to identify component: "+c.message,errorCode:400})}}else{a.setError({errorMessage:"Unable to identify component",errorCode:500})}})},setLegacyClmComponent:function(a,c,d,b){if(c!=="maven"){a.setError({errorMessage:"Unsupported repository format, please upgrade to Nexus IQ Server 1.13 or greater.",errorCode:400});return}a.setGav({groupId:d.groupId,artifactId:d.artifactId,version:d.version,extension:d.extension,classifier:d.classifier,hash:b})},registerClmViewDetailsListener:function(a){var b=this;if(b.isLegacyClm(a)){b.registerLegacyClmViewDetailsListener(a)}else{a.registerCoordsViewDetailsListener(function(h,g,j,f){var c={format:g,coordinates:{}},e={appId:h,hash:f};if(j){for(var d=0;d<j.length;d+=2){c.coordinates[j[d]]=j[d+1]}}e.componentIdentifier=JSON.stringify(c);if(j){NX.Windows.open(NX.util.Url.urlOf("service/siesta/healthcheck/clm/assets/version-graph/rm/nexus/viewdetails.html?"+Ext.Object.toQueryString(e)))}})}},registerLegacyClmViewDetailsListener:function(a){a.registerViewDetailsListener(function(g,c,i,b,f,h,e){var d={appId:g,hash:e,groupId:c,artifactId:i,version:b,classifier:f,extension:h};NX.Windows.open(NX.util.Url.urlOf("service/siesta/healthcheck/clm/assets/version-graph/rm/nexus/viewdetails.html?"+Ext.Object.toQueryString(d)))})},showDetails:function(d,c,b,a){Sonatype.view.mainTabPanel.addOrShowTab(me.toTabId(d,c,b,a),Nexus.clm.ComponentDetailView,{title:"IQ Server Detail",appId:d,hash:c,component:!a?b:null,gav:a?b.coordinates:null})},isLegacyClm:function(a){return !(a.registerCoordsViewDetailsListener||a.setCoordinates)}});Ext.define("NX.proui.controller.HealthCheckRepositoryDetail",{extend:"NX.app.Controller",requires:["NX.Permissions","NX.Windows"],init:function(){var a=this;a.listen({component:{"nx-coreui-healthcheck-summary":{afterrender:a.addDetailButton},"nx-coreui-healthcheck-summary button[action=viewdetail]":{click:a.viewDetail}}})},addDetailButton:function(c){var a=c.statusModel,b;if(a&&a.get("detailedReportSupported")){if(!c.getDockedItems('toolbar[dock="bottom"]').length){c.addDocked({xtype:"toolbar",dock:"bottom",items:[]})}b=c.getDockedItems('toolbar[dock="bottom"]')[0];if(a.get("detailUrl")){b.add(["->",{xtype:"button",text:"View Detailed Report",action:"viewdetail",disabled:!NX.Permissions.check("nexus:healthcheckdetail:read")}])}else{b.add(["->","The next analysis will include the detailed report."])}}},viewDetail:function(b){var c=b.up("window"),a=c.statusModel;NX.Windows.open(a.get("detailUrl"));c.close()}});Ext.define("NX.proui.model.FirewallRepositoryStatus",{extend:"Ext.data.Model",fields:[{name:"repositoryName",type:"string",sortType:"asUCText"},{name:"affectedComponentCount",type:"int"},{name:"criticalComponentCount",type:"int"},{name:"moderateComponentCount",type:"int"},{name:"quarantinedComponentCount",type:"int"},{name:"severeComponentCount",type:"int"},{name:"reportUrl",type:"string",sortType:"asUCText"},{name:"message",type:"string",sortType:"asUCText"},{name:"errorMessage",type:"string",sortType:"asUCText"}]});Ext.define("NX.proui.store.FirewallRepositoryStatus",{extend:"Ext.data.Store",model:"NX.proui.model.FirewallRepositoryStatus",loaded:false,proxy:{type:"direct",paramsAsHash:false,api:{read:"NX.direct.firewall_RepositoryStatus.read"},reader:{type:"json",root:"data",idProperty:"repositoryName",successProperty:"success"}},listeners:{beforeload:function(){this.loaded=false},load:function(){this.loaded=true}}});Ext.define("NX.proui.controller.FirewallRepositoryColumn",{extend:"NX.app.Controller",requires:["Ext.grid.column.Column","Ext.XTemplate","NX.Conditions","NX.Permissions","NX.I18n","NX.Icons","NX.ext.grid.column.Renderers","NX.Windows"],models:["FirewallRepositoryStatus"],stores:["FirewallRepositoryStatus"],refs:[{ref:"list",selector:"nx-coreui-repository-list"}],init:function(){var a=this;a.getApplication().getIconController().addIcons({"license-alert":{file:"license-alert.png",variants:["x16"]},"security-alert":{file:"security-alert.png",variants:["x16"]}});a.listen({controller:{"#Permissions":{changed:a.refreshFirewallColumn}},store:{"#Repository":{load:a.loadFirewallStatus},"#FirewallRepositoryStatus":{load:a.refreshFirewallColumn}},component:{"nx-coreui-repository-list":{afterrender:a.bindFirewallColumn}}});a.firewallColumnTemplate=Ext.create("Ext.XTemplate",'<div class="nx-firewall-container">','<tpl if="criticalCount &gt; 0">','<div class="nx-firewall-chiclet critical">{criticalCount}</div>',"</tpl>",'<tpl if="severeCount &gt; 0">','<div class="nx-firewall-chiclet severe">{severeCount}</div>',"</tpl>",'<tpl if="moderateCount &gt; 0">','<div class="nx-firewall-chiclet moderate">{moderateCount}</div>',"</tpl>",'<tpl if="!criticalCount && !severeCount && !moderateCount">','<div style="float:left;">'+NX.I18n.get("FirewallRepositoryColumn_NoViolations")+"</div>","</tpl>",'<tpl if="quarantinedCount &gt; 0">','<div class="nx-firewall-quarantine-icon"></div><div class="nx-firewall-quarantine-count">{quarantinedCount}</div>',"</tpl>",'<div class="nx-external-link"></div>',"</div>",{compiled:true});a.firewallColumnMessageTemplate=Ext.create("Ext.XTemplate",'<div class="nx-firewall-container">','<div style="float:left;">{message}</div>',"</div>",{compiled:true});a.firewallColumnErrorTemplate=Ext.create("Ext.XTemplate",'<div class="nx-firewall-container">','<div class="nx-firewall-iq-error-icon"></div>','<div class="nx-firewall-error">{errorMessage}</div>',"</div>",{compiled:true})},loadFirewallStatus:function(){var a=this,b=a.getList();if(b){a.getFirewallRepositoryStatusStore().load()}},bindFirewallColumn:function(a){var b=this;b.addFirewallColumn(a)},addFirewallColumn:function(b){var d=this,a=b.getView(),c=b.firewallColumn;if(!c){c=b.firewallColumn=Ext.create("Ext.grid.column.Column",{id:"firewallColumn",header:NX.I18n.get("FirewallRepositoryColumn_Header"),hideable:false,sortable:false,menuDisabled:true,stateId:"firewall",width:120,align:"center",renderer:Ext.bind(d.renderFirewallColumn,d),listeners:{click:Ext.bind(d.viewReportHandler,d)}});b.headerCt.add(c);a.refresh()}},renderFirewallColumn:function(g,d,c){var f=this,a=f.getFirewallRepositoryStatusStore().getById(c.getId());if(a){if(a.get("errorMessage")){var b=Ext.util.Format.htmlEncode(a.get("errorMessage"));d.tdAttr='data-qtip="'+b+'"';return f.firewallColumnErrorTemplate.apply({errorMessage:b})}else{if(a.get("message")){var e=Ext.util.Format.htmlEncode(a.get("message"));d.tdAttr='data-qtip="'+e+'"';return f.firewallColumnMessageTemplate.apply({message:e})}}return f.firewallColumnTemplate.apply({criticalCount:a.get("criticalComponentCount"),severeCount:a.get("severeComponentCount"),moderateCount:a.get("moderateComponentCount"),quarantinedCount:a.get("quarantinedComponentCount")})}else{if(f.getFirewallRepositoryStatusStore().loaded){return NX.ext.grid.column.Renderers.optionalData(null)}}return NX.I18n.get("FirewallRepositoryColumn_Loading")},refreshFirewallColumn:function(){var a=this.getList();if(a){a.getView().refresh()}},viewReportHandler:function(h,b,g,d,f,c){var e=this;var a=e.getFirewallRepositoryStatusStore().getById(c.getId());if(a&&a.get("reportUrl")){NX.Windows.open(a.get("reportUrl"),"_blank")}return false}});Ext.define("NX.proui.controller.LicenseWarnings",{extend:"NX.app.Controller",requires:["NX.I18n","NX.Permissions"],refs:[{ref:"licenseWarning",selector:"#nx-license-warning"}],daysToWarn:30,init:function(){var a=this;a.listen({controller:{"#State":{licensechanged:a.updateLicenseExpiryWarning},"#Permissions":{changed:a.updateLicenseExpiryWarning}}})},updateLicenseExpiryWarning:function(){var c=this,b=NX.State.getDaysToLicenseExpiry(),a=c.getLicenseWarning();if(a){if(b!=null){if(b<0){c.setLicenseWarning(NX.I18n.get("State_License_Expired"))}else{if(b<c.daysToWarn){c.setLicenseWarning(NX.I18n.format("State_License_Expiry",b))}}}else{a.hide()}}},setLicenseWarning:function(c){var b=this,a=b.getLicenseWarning();a.setTitle(c);a.show()}});Ext.define("NX.proui.view.usertoken.UserTokenDetails",{extend:"Ext.window.Window",alias:"widget.nx-proui-usertoken-details",requires:["NX.Icons","NX.Messages","NX.I18n"],nameCode:undefined,passCode:undefined,initComponent:function(){var a=this;a.title=NX.I18n.get("UserToken_UserTokenDetails_Title");a.autoShow=true;a.modal=true;a.constrain=true;a.width=640;a.resizable=false;a.items={xtype:"form",bodyPadding:10,items:[{xtype:"panel",layout:"hbox",items:[{xtype:"component",html:NX.Icons.img("usertoken-default","x32")},{xtype:"label",margin:"0 0 0 5",html:NX.I18n.get("UserToken_UserTokenDetails_Html1")}]},{xtype:"label",html:NX.I18n.get("UserToken_UserTokenDetails_Html2")},{xtype:"panel",layout:"hbox",items:[{xtype:"textfield",name:"nameCode",value:a.nameCode,width:100,readOnly:true,selectOnFocus:true,fieldCls:"user-token-field"},{xtype:"label",html:":",cls:"nx-user-token-field"},{xtype:"textfield",name:"passCode",value:a.passCode,width:360,readOnly:true,selectOnFocus:true,fieldCls:"user-token-field"}]},{xtype:"label",html:NX.I18n.get("UserToken_UserTokenDetails_Html3")},{xtype:"textarea",value:"<server>\n  <id>${server}</id>\n  <username>"+a.nameCode+"</username>\n  <password>"+a.passCode+"</password>\n</server>",height:90,width:610,readOnly:true,selectOnFocus:true,fieldCls:"user-token-field"},{xtype:"label",html:NX.I18n.get("UserToken_UserTokenDetails_AutoClose_Html")}],buttonAlign:"left",buttons:[{text:NX.I18n.get("Button_Close"),ui:"nx-primary",handler:function(){this.up("window").close()}}]};a.callParent();Ext.defer(function(){if(a.isVisible()){NX.Messages.add({text:NX.I18n.get("UserToken_UserTokenDetails_AutoClosing_Message")});a.close()}},1*60*1000)}});Ext.define("NX.proui.controller.Crowd",{extend:"NX.app.Controller",requires:["NX.Permissions","NX.Messages","NX.I18n"],views:["crowd.CrowdSettings"],init:function(){var a=this;a.getApplication().getIconController().addIcons({"crowd-security-source":{file:"crowd.png",variants:["x16"]}});a.getApplication().getFeaturesController().registerFeature({mode:"admin",path:"/Security/Atlassian Crowd",text:NX.I18n.get("Crowd_Text"),description:NX.I18n.get("Crowd_Description"),view:{xtype:"nx-proui-crowd-settings"},iconConfig:{file:"crowd.png",variants:["x16","x32"]},visible:function(){return NX.Permissions.check("nexus:crowd:read")}},a);a.listen({component:{"nx-proui-crowd-settings button[action=verify]":{click:a.verifyConnection},"nx-proui-crowd-settings button[action=clearCache]":{click:a.clearCache}}})},verifyConnection:function(b){var c=b.up("form"),a=c.getForm().getFieldValues();c.getEl().mask("Checking connection to "+a.url);NX.direct.crowd_Crowd.verifyConnection(a,function(d){c.getEl().unmask();if(Ext.isDefined(d)&&d.success){NX.Messages.add({text:NX.I18n.format("Crowd_CrowdSettings_Verified_Success",a.url),type:"success"})}})},clearCache:function(a){var b=a.up("form");b.getEl().mask("Clearing cache...");NX.direct.crowd_Crowd.clearCache(function(c){b.getEl().unmask();if(Ext.isDefined(c)&&c.success){NX.Messages.add({text:NX.I18n.format("Crowd_CrowdSettings_ClearCache_Success"),type:"success"})}})}});Ext.define("NX.proui.view.database.DatabaseQuorumResetConfirm",{extend:"NX.view.SettingsPanel",alias:"widget.nx-proui-database-quorum-reset",requires:["NX.I18n"],initComponent:function(){var a=this;Ext.apply(a,{settingsForm:{xtype:"nx-settingsform",items:[{xtype:"label",html:'<h3>Resetting the Database Write Quorum</h3><p>Resetting the database write quorum is not meant to fix all problems related to Nexus clustering. However it can be used if you would like to reduce your cluster down to a single node and rebuild your cluster.</p><p>It is important to understand the implications of resetting the write quorum. In doing so, you will move from having a "cluster" to only having one working node. If that is your intention, then we suggest that you first attempt to shut down any other running Nexus nodes.</p><p>To recreate your cluster after resetting the write quorum, you will need to reattach nodes to the cluster. The new nodes that join your cluster, after resetting the write quorum, may need to replicate all of the Nexus databases. This may consume considerable time and resources.</p>'}],buttonAlign:"left",buttons:[{xtype:"button",text:NX.I18n.get("DatabaseQuorumReset_ResetButton"),glyph:"xf019@FontAwesome",action:"resetQuorum"}]}});a.callParent()}});Ext.define("NX.proui.view.usertoken.UserTokenSettings",{extend:"NX.view.SettingsPanel",alias:"widget.nx-proui-usertoken-settings",requires:["NX.Conditions","NX.I18n"],initComponent:function(){Ext.apply(this,{settingsForm:[{xtype:"nx-settingsform",settingsFormSuccessMessage:NX.I18n.get("UserTokenSettings_Update_Success"),api:{load:"NX.direct.usertoken_UserToken.read",submit:"NX.direct.usertoken_UserToken.update"},editableCondition:NX.Conditions.isPermitted("nexus:usertoken:settings:update"),editableMarker:NX.I18n.get("UserTokenSettings_Update_Error"),items:[{xtype:"label",html:NX.I18n.get("UserTokenSettings_Html")},{xtype:"checkbox",name:"enabled",fieldLabel:NX.I18n.get("UserTokenSettings_Enable_FieldLabel")},{xtype:"checkbox",name:"protectContent",fieldLabel:NX.I18n.get("UserTokenSettings_Require_FieldLabel"),helpText:NX.I18n.get("UserTokenSettings_Require_HelpText")}]},{xtype:"form",ui:"nx-subsection",frame:true,itemId:"resetAll",title:NX.I18n.get("UserTokenSettings_Reset_Title"),hidden:true,items:[{xtype:"label",html:NX.I18n.get("UserTokenSettings_Reset_Html")}],buttonAlign:"left",buttons:[{text:NX.I18n.get("UserTokenSettings_ResetAll_Button"),action:"resetall",ui:"nx-primary",glyph:"xf023@FontAwesome"}]}]});this.callParent()}});Ext.define("NX.proui.controller.UserToken",{extend:"NX.app.Controller",requires:["NX.Conditions","NX.Messages","NX.Permissions","NX.Security","NX.State","NX.I18n"],views:["usertoken.UserTokenCurrent","usertoken.UserTokenDetails","usertoken.UserTokenSettings","usertoken.UserTokenUser"],refs:[{ref:"userUserTokenPanel",selector:"nx-coreui-user-feature nx-proui-usertoken-user"}],init:function(){var a=this;a.getApplication().getIconController().addIcons({"feature-usertoken":{file:"key.png",variants:["x16","x32"]},"usertoken-default":{file:"key.png",variants:["x16","x32"]}});a.getApplication().getFeaturesController().registerFeature([{mode:"admin",path:"/Security/User Token",view:{xtype:"nx-proui-usertoken-settings"},text:NX.I18n.get("UserToken_Text"),description:NX.I18n.get("UserToken_Description"),iconConfig:{file:"key.png",variants:["x16","x32"]},visible:function(){return NX.Permissions.check("nexus:usertoken:settings:read")}},{mode:"user",path:"/User Token",text:NX.I18n.get("UserToken_Text"),description:NX.I18n.get("UserToken_Description"),view:{xtype:"nx-proui-usertoken-current"},iconConfig:{file:"key.png",variants:["x16","x32"]},visible:function(){var b=NX.State.getValue("usertoken");return NX.Permissions.check("nexus:usertoken:current:read")&&b&&b.enabled}}],a);a.listen({component:{"nx-proui-usertoken-settings button[action=resetall]":{click:a.resetAll,afterrender:a.bindResetAllButton},"nx-proui-usertoken-settings nx-settingsform":{loaded:a.onLoaded,submitted:a.onSubmitted},"nx-proui-usertoken-current button[action=access]":{click:a.accessCurrent,afterrender:a.bindAccessButton},"nx-proui-usertoken-current button[action=reset]":{click:a.resetCurrent,afterrender:a.bindResetCurrentButton},"nx-coreui-user-list":{beforerender:a.bindUserUserTokenTab,selection:a.onUserSelection},"nx-proui-usertoken-user button[action=reset]":{click:a.reset,afterrender:a.bindResetButton}}})},onLoaded:function(a,b){var c=a.up("nx-proui-usertoken-settings").down("#resetAll");if(b.result.data.enabled){c.show()}else{c.hide()}},onSubmitted:function(a,b){NX.State.setValue("usertoken",Ext.apply(NX.State.getValue("usertoken",{}),{enabled:b.result.data.enabled}))},onUserSelection:function(c,b){var a=this.getUserUserTokenPanel();if(Ext.isDefined(b)&&a){a.down("form").loadRecord(b)}},bindUserUserTokenTab:function(b){var a=this;b.mon(NX.Conditions.watchState("usertoken",function(c){return c&&c.enabled}),{satisfied:function(){var c=a.getUserUserTokenPanel();if(!c){a.fireEvent("userSettingsAddTab",{xtype:"nx-proui-usertoken-user"})}},unsatisfied:function(){var c=a.getUserUserTokenPanel();if(c){a.fireEvent("userSettingsRemoveTab",{xtype:"nx-proui-usertoken-user"})}},scope:a})},bindResetAllButton:function(a){a.mon(NX.Conditions.and(NX.Conditions.isPermitted("nexus:usertoken:users:delete")),{satisfied:a.enable,unsatisfied:a.disable,scope:a})},bindAccessButton:function(a){a.mon(NX.Conditions.and(NX.Conditions.isPermitted("nexus:usertoken:current:read")),{satisfied:a.enable,unsatisfied:a.disable,scope:a})},bindResetCurrentButton:function(a){a.mon(NX.Conditions.and(NX.Conditions.isPermitted("nexus:usertoken:current:delete")),{satisfied:a.enable,unsatisfied:a.disable,scope:a})},bindResetButton:function(a){a.mon(NX.Conditions.and(NX.Conditions.isPermitted("nexus:usertoken:user:delete")),{satisfied:a.enable,unsatisfied:a.disable,scope:a})},resetAll:function(){NX.Security.doWithAuthenticationToken(NX.I18n.format("UserToken_Authentication_Validation","Resetting"),{success:function(a){NX.direct.usertoken_UserToken.resetAll(a,function(b){if(Ext.isDefined(b)&&b.success){NX.Messages.add({text:NX.I18n.get("UserToken_ResetAll_Success"),type:"success"})}})}})},accessCurrent:function(){NX.Security.doWithAuthenticationToken(NX.I18n.format("UserToken_Authentication_Validation","Accessing"),{success:function(a){NX.direct.usertoken_UserToken.retrieveCurrent(a,function(b){if(Ext.isDefined(b)&&b.success){Ext.widget("nx-proui-usertoken-details",b.data)}})}})},resetCurrent:function(){NX.Security.doWithAuthenticationToken(NX.I18n.format("UserToken_Authentication_Validation","Resetting"),{success:function(a){NX.direct.usertoken_UserToken.resetCurrent(a,function(b){if(Ext.isDefined(b)&&b.success){NX.Messages.add({text:NX.I18n.get("UserToken_Reset_Success"),type:"success"})}})}})},reset:function(a){var c=a.up("form"),b=c.getRecord();NX.Security.doWithAuthenticationToken(NX.I18n.format("UserToken_Authentication_Validation","Resetting"),{success:function(d){NX.direct.usertoken_UserToken.reset(d,b.getId(),function(e){if(Ext.isDefined(e)&&e.success){NX.Messages.add({text:NX.I18n.format("UserToken_ResetById_Message",b.getId()),type:"success"})}})}})}});Ext.define("NX.proui.controller.HealthCheckInfo",{extend:"NX.app.Controller",requires:["NX.Conditions","NX.Permissions","NX.State","NX.util.Url","NX.I18n","NX.coreui.util.HealthCheckUtil"],init:function(){var a=this;a.listen({component:{"nx-coreui-component-details":{healthCheckLoaded:a.renderHealthCheckFields},"nx-coreui-component-details #healthCheckInfo":{afterrender:a.bindHealthCheckInfo}}})},bindHealthCheckInfo:function(b){var c=this,a=b.up("nx-coreui-component-details");a.mon(NX.Conditions.isPermitted("nexus:healthcheck:read"),{satisfied:Ext.pass(c.addHealthCheckInfo,a),unsatisfied:Ext.pass(c.removeHealthCheckInfo,a),scope:c})},addHealthCheckInfo:function(a){var b=a.down("#healthCheckInfoPro");if(!b){a.add({xtype:"nx-info",itemId:"healthCheckInfoPro"})}},removeHealthCheckInfo:function(a){var b=a.down("#healthCheckInfoPro");if(b){a.remove(b)}},renderHealthCheckFields:function(a,b){var c=this,d=a.down("#healthCheckInfoPro"),e={};if(d){if(b){e[NX.I18n.get("HealthCheckInfo_Security_Alerts_Label")]=c.renderSecurityAlerts(b);e[NX.I18n.get("HealthCheckInfo_License_Threat_Label")]=c.renderLicenseThreat(b)}d.showInfo(e)}},renderSecurityAlerts:function(c){var f=this,g={},i,b,h,e,a,d=function(j,k){return'<span class="nx-clm-chiclet-small '+j+'">'+k+"</span>"};i=f.renderPreconditions(c,g);if(!i){b=c.get("healthCheckSecurityAlerts");h=c.get("healthCheckCriticalSecurityAlerts");e=c.get("healthCheckSevereSecurityAlerts");a=c.get("healthCheckModerateSecurityAlerts");if(b===0||b>0){i=d(h>0?"critical":"",h>0?h:"")+d(e>0?"severe":"",e>0?e:"")+d(a>0?"moderate":"",a>0?a:"")}if(!Ext.isDefined(i)){i=f.renderNotAvailable(g)}}return"<div "+(g.attr||"")+">"+i+"</div>"},renderLicenseThreat:function(b){var f=this,c={},a,e,d,g="";a=f.renderPreconditions(b,c);if(!a){e=b.get("healthCheckLicenseThreat");d=b.get("healthCheckLicenseThreatName");if(e===0||e>0){if(e===4){g="critical"}else{if(e===2){g="moderate"}else{if(e===1){g="none"}else{g="severe"}}}return'<span class="nx-clm-chiclet-small '+g+'" style="width: auto; padding: 1px 2px; font-size: inherit;">'+d+"</span>"}if(!Ext.isDefined(a)){a=f.renderNotAvailable(c)}}return"<div "+(c.attr||"")+">"+a+"</div>"},renderPreconditions:function(b,c){var d=NX.State.getEdition(),a=NX.coreui.util.HealthCheckUtil;if("EVAL"===d||"OSS"===d){c.attr='data-qtip="'+NX.I18n.get("HealthCheckInfo_Tooltip")+'"';return a.iconSpan("fa-lock","opacity: 0.33;")}else{if(!NX.State.getUser()){c.attr='data-qtip="'+NX.I18n.get("HealthCheckInfo_LoggedInOnly_Tooltip")+'"';return a.iconSpan("fa-lock","opacity: 0.33;")}else{if(!NX.Permissions.check("nexus:healthcheckalerts:update")){c.attr='data-qtip="'+NX.I18n.get("HealthCheckInfo_NoPermission_Tooltip")+'"';return a.iconSpan("fa-lock","opacity: 0.33;")}else{if(b.get("healthCheckLoading")){return NX.I18n.get("HealthCheckInfo_Loading_Text")}else{if(b.get("healthCheckDisabled")){c.attr='data-qtip="'+NX.I18n.get("HealthCheckInfo_Disabled_Tooltip")+'"';return a.iconSpan("fa-info-circle","opacity: 0.33;")}else{if(b.get("healthCheckError")){c.attr='data-qtip="'+NX.I18n.get("HealthCheckInfo_Error_Tooltip")+'"';return a.iconSpan("fa-exclamation-triangle","color: red;")}else{if(b.get("healthCheckCapped")||(b&&b.get("cappedAlerts"))){c.attr='data-qtip="'+NX.I18n.get("HealthCheckInfo_Quota_Tooltip")+'"';return a.iconSpan("fa-exclamation-triangle","color: yellow;")}}}}}}}return undefined},renderNotAvailable:function(a){a.attr='data-qtip="'+NX.I18n.get("HealthCheckInfo_Unavailable_Tooltip")+'"';return NX.coreui.util.HealthCheckUtil.iconSpan("fa-ban","opacity: 0.33;")}});Ext.define("NX.proui.controller.FeatureGroups",{extend:"NX.app.Controller",requires:["NX.I18n"],init:function(){this.getApplication().getFeaturesController().registerFeature([{mode:"admin",path:"/IQ",text:"IQ Server",description:"IQ Server integration",group:true,weight:70,iconConfig:{file:"three_tags.png",variants:["x16","x32"]}}])}});Ext.define("NX.proui.controller.HealthCheckAssetDetail",{extend:"NX.app.Controller",requires:["NX.Permissions","NX.State"],views:["healthcheck.HealthCheckAssetDetail"],init:function(){var a=this;a.listen({component:{"nx-coreui-component-assetcontainer":{updated:a.onUpdated}}})},onUpdated:function(b,c){var d=NX.State.getEdition(),a=b.down("nx-proui-healthcheck-healthcheckassetdetail");if(NX.State.getUser()&&NX.Permissions.check("nexus:healthcheckalerts:read")&&!("EVAL"===d||"OSS"===d)){if(!a){b.addTab({xtype:"nx-proui-healthcheck-healthcheckassetdetail",title:NX.I18n.get("Component_AssetInfo_HealthCheck_Title"),itemId:"healthCheckInfo",weight:30,minHeight:600});a=b.down("nx-proui-healthcheck-healthcheckassetdetail")}a.showInfo(c)}else{if(a){b.remove(a)}}}});Ext.define("NX.proui.controller.DatabaseQuorumReset",{extend:"NX.app.Controller",requires:["NX.Permissions","NX.Messages","NX.I18n"],views:["database.DatabaseQuorumResetConfirm"],init:function(){var a=this;a.getApplication().getFeaturesController().registerFeature({mode:"admin",path:"/System/Nodes/Cluster Reset",text:NX.I18n.get("DatabaseQuorumReset_Title"),description:NX.I18n.get("DatabaseQuorumReset_Description"),view:{xtype:"nx-proui-database-quorum-reset"},visible:function(){return NX.Permissions.check("nexus:settings:update")&&!NX.State.getValue("quorum",{})["quorumPresent"]}},a);a.listen({component:{"nx-proui-database-quorum-reset button[action=resetQuorum]":{click:a.resetQuorum}}});a.myNodeId=null;NX.direct.node_NodeAccess.nodes(function(b){if(Ext.isObject(b)&&b.success){b.data.forEach(function(c){if(c.local){a.myNodeId=c.name}})}else{NX.Messages.add({text:NX.I18n.get("DatabaseQuorumResetConfirm_GetLocalNode_Fail"),type:"warning"})}})},resetQuorum:function(){var a=this;if(a.myNodeId==null){NX.Messages.add({text:NX.I18n.get("DatabaseQuorumResetConfirm_LocalNodeNotKnown"),type:"warning"})}else{NX.Dialogs.askConfirmation(NX.I18n.get("DatabaseQuorumResetConfirm_Title"),NX.I18n.format("DatabaseQuorumResetConfirm_HelpText"),function(){NX.direct.proui_Database.resetQuorum(a.myNodeId,function(b){if(Ext.isObject(b)&&b.success){NX.Messages.add({text:NX.I18n.get("DatabaseQuorumResetConfirm_Success"),type:"success"});NX.Bookmarks.navigateTo(NX.Bookmarks.fromToken("admin/system/nodes"))}else{NX.Messages.add({text:NX.I18n.get("DatabaseQuorumResetConfirm_Fail"),type:"warning"})}})},{scope:a})}}});
.-vÿ¹      Yz!?Yz!>>‰uY¡¦   L    :http://10.0.2.15:8081/static/rapture/nexus-proui-plugin-prod.js?_v=3.4.0-02 strongly-framed 1 request-method GET response-head HTTP/1.1 200 OK
Date: Thu, 27 Jul 2017 16:47:22 GMT
Server: Nexus/3.4.0-02 (OSS)
X-Frame-Options: SAMEORIGIN
X-Content-Type-Options: nosniff
Content-Type: application/javascript
Last-Modified: Thu, 27 Jul 2017 16:38:49 GMT
Cache-Control: max-age=2592000
Content-Length: 45654
 original-response-headers Date: Thu, 27 Jul 2017 16:47:22 GMT
Server: Nexus/3.4.0-02 (OSS)
X-Frame-Options: SAMEORIGIN
X-Content-Type-Options: nosniff
Content-Type: application/javascript
Last-Modified: Thu, 27 Jul 2017 16:38:49 GMT
Cache-Control: max-age=2592000
Content-Length: 45654
 uncompressed-len 0   ²V